import{R as v,r as p,j as e,Y as G,b as A}from"./app-WTHt1LSi.js";import{c as O,g as L,m as M,C as V,o as W,A as z,B as C}from"./AuthenticatedLayout-NK43SbJu.js";import{i as N,a as c,I as g,b as j,R as T,C as S,F as B,S as D,c as Q}from"./Table-D1yEHtpt.js";import{M as _}from"./index-BRxVF3WE.js";import{s as J}from"./index-CSmRDWBX.js";import"./useForceUpdate-DnUyU4Vs.js";const I=["wrap","nowrap","wrap-reverse"],q=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],F=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"],H=(t,s)=>{const a=s.wrap===!0?"wrap":s.wrap;return{[`${t}-wrap-${a}`]:a&&I.includes(a)}},X=(t,s)=>{const a={};return F.forEach(r=>{a[`${t}-align-${r}`]=s.align===r}),a[`${t}-align-stretch`]=!s.align&&!!s.vertical,a},Y=(t,s)=>{const a={};return q.forEach(r=>{a[`${t}-justify-${r}`]=s.justify===r}),a};function U(t,s){return O(Object.assign(Object.assign(Object.assign({},H(t,s)),X(t,s)),Y(t,s)))}const Z=t=>{const{componentCls:s}=t;return{[s]:{display:"flex","&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}},K=t=>{const{componentCls:s}=t;return{[s]:{"&-gap-small":{gap:t.flexGapSM},"&-gap-middle":{gap:t.flexGap},"&-gap-large":{gap:t.flexGapLG}}}},ee=t=>{const{componentCls:s}=t,a={};return I.forEach(r=>{a[`${s}-wrap-${r}`]={flexWrap:r}}),a},te=t=>{const{componentCls:s}=t,a={};return F.forEach(r=>{a[`${s}-align-${r}`]={alignItems:r}}),a},se=t=>{const{componentCls:s}=t,a={};return q.forEach(r=>{a[`${s}-justify-${r}`]={justifyContent:r}}),a},ae=()=>({}),re=L("Flex",t=>{const{paddingXS:s,padding:a,paddingLG:r}=t,l=M(t,{flexGapSM:s,flexGap:a,flexGapLG:r});return[Z(l),K(l),ee(l),te(l),se(l)]},ae,{resetStyle:!1});var ne=function(t,s){var a={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&s.indexOf(r)<0&&(a[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,r=Object.getOwnPropertySymbols(t);l<r.length;l++)s.indexOf(r[l])<0&&Object.prototype.propertyIsEnumerable.call(t,r[l])&&(a[r[l]]=t[r[l]]);return a};const le=v.forwardRef((t,s)=>{const{prefixCls:a,rootClassName:r,className:l,style:d,flex:h,gap:i,children:w,vertical:m=!1,component:y="div"}=t,f=ne(t,["prefixCls","rootClassName","className","style","flex","gap","children","vertical","component"]),{flex:n,direction:o,getPrefixCls:x}=v.useContext(V),u=x("flex",a),[$,k,P]=re(u),E=m??(n==null?void 0:n.vertical),R=O(l,r,n==null?void 0:n.className,u,k,P,U(u,t),{[`${u}-rtl`]:o==="rtl",[`${u}-gap-${i}`]:N(i),[`${u}-vertical`]:E}),b=Object.assign(Object.assign({},n==null?void 0:n.style),d);return h&&(b.flex=h),i&&!N(i)&&(b.gap=i),$(v.createElement(y,Object.assign({ref:s,className:R,style:b},W(f,["justify","wrap","align"])),w))});function xe(t){var f;const[s,a]=p.useState([]);p.useState();const[r,l]=p.useState(t.products),d=p.useRef(null),[h,i]=p.useState(!1),w=n=>new Promise(()=>o=>setTimeout(o,n)),m=()=>{const n=d.current.getFieldsValue(),o=t.products.find(x=>x.id===n.product);n.code=o.code,n.name=o.name,n.id=o.id,a([...s,n]),l(t.products)},y=async n=>{i(!0),w(300),n.items=s,A.post(route("order.add.new"),n).then(o=>{d.current.resetFields(),i(!1),a([]),J.open({message:"Emitido",type:"success",description:"Aguarde a impressao"}),window.open(route("order.print",o.data.id),"_blank","width=800,height=500,top=200,left=200")}).catch(o=>{i(!1)})};return e.jsx(e.Fragment,{children:e.jsxs(z,{user:t.auth.user,page:"Nova Requisição",header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:"Nova Requisição"}),children:[e.jsx(G,{title:"Nova Requisição"}),e.jsxs(c,{layout:"vertical",ref:d,onFinish:y,children:[e.jsx("p",{className:"font-bold text-lg mb-4",children:"* Detalhes da Req"}),e.jsxs("div",{className:"shadow p-4 bg-white",children:[e.jsx(c.Item,{label:"Codigo da requisicao (Opcional)",name:"code",children:e.jsx(g,{placeholder:"Opcional",allowClear:!0})}),e.jsx(c.Item,{label:"Motorista",name:"driver",rules:[{required:!0,message:"Indique o motorista"}],children:e.jsx(g,{placeholder:"Motorista",allowClear:!0})}),e.jsx(c.Item,{label:"Matricula",name:"registration",rules:[{required:!0,message:"Indique a matricula"}],children:e.jsx(g,{placeholder:"Viatura",allowClear:!0})}),e.jsx(c.Item,{label:"Estação",name:"station",rules:[{required:!0,message:"Selecione uma estação "}],children:e.jsx(j,{placeholder:"Estação",showSearch:!0,optionFilterProp:"children",allowClear:!0,children:(f=t.stations)==null?void 0:f.map((n,o)=>e.jsx(j.Option,{value:n.id,children:n.name},o))})}),e.jsx(c.Item,{label:"Observação (Nota)",name:"notes",children:e.jsx(g.TextArea,{placeholder:"Observação",allowClear:!0})})]}),e.jsx("p",{className:"font-bold text-lg mb-4 mt-4",children:"* Adicione Productos"}),e.jsx("div",{className:"shadow p-4 bg-white mt-4",children:e.jsxs(T,{gutter:12,children:[e.jsx(S,{xs:10,children:e.jsx(c.Item,{label:"Productos",name:"product",rules:[{required:!0,message:"Selecione um producto"}],children:e.jsx(j,{placeholder:"Productos",showSearch:!0,optionFilterProp:"children",children:r.map((n,o)=>e.jsx(j.Option,{value:n.id,children:n.name},o))})})}),e.jsx(S,{xs:8,children:e.jsx(c.Item,{label:"Quantidade",name:"quantity",rules:[{required:!0,message:"indique quantidade"}],children:e.jsx(g,{type:"number",placeholder:"Quantidade",allowClear:!0,minLength:1,min:1})})}),e.jsx(S,{children:e.jsx(c.Item,{label:" ",children:e.jsxs(C,{className:"flex gap-1 bg-red-400 text-white",onClick:()=>m(),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),"Adicionr Item"]})})})]})})]}),e.jsxs("div",{className:"shadow-lg bg-white mt-4 p-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{}),e.jsxs(C,{className:"flex gap-1 bg-green-400 text-white mb-4",disabled:!(s.length>0),onClick:()=>d.current.submit(),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9 9 6-6m0 0 6 6m-6-6v12a6 6 0 0 1-12 0v-3"})}),"Emitir a requisição"]})]}),e.jsx(B,{dataSource:s,columns:[{key:"code",dataIndex:"code",title:"Codigo"},{key:"name",dataIndex:"name",title:"Producto"},{key:"qty",dataIndex:"quantity",title:"Quantidade"},{key:"remove",title:"Opcoes",render:n=>e.jsx(e.Fragment,{children:e.jsx(C,{color:"red",onClick:()=>{const o=s.filter(x=>x.id!=n.id);a(o)},children:"Remover"})})}]})]}),e.jsx(_,{open:h,footer:null,children:e.jsxs(le,{align:"center",gap:"middle",children:[e.jsx("p",{className:"font-bold text-2xl",children:"Aguarde...."}),e.jsx(D,{}),e.jsx(Q,{size:"large"})]})})]})})}export{xe as default};
