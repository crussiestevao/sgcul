import{r,j as e,Y as O}from"./app-XYcvX45B.js";import{M as z}from"./index-bbd4PJy1.js";import{S as R}from"./Skeleton-CtHg8bVf.js";import{F as i,R as f,C as h,I as x,b as P,a as A,S as q}from"./Table-DHwjyzK4.js";import{I as T,_,A as B,B as E}from"./AuthenticatedLayout-Dsx34QZr.js";import{s as k}from"./index-DWeqfO5x.js";import{s as M}from"./index-BGnumeXB.js";import{P as D}from"./index-BfuchIVM.js";import"./useForceUpdate-D1UJB1O2.js";var U={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"}}]},name:"user",theme:"outlined"},$=function(d,n){return r.createElement(T,_({},d,{ref:n,icon:U}))},L=r.forwardRef($);function V({openEdit:l,setOpenEdit:d,selectedUser:n,props:c,setSelectedUser:F,setDataSource:y}){var b;const j=r.useRef(null),[C,g]=r.useState(!1),[w,S]=r.useState(!1),u=t=>t,p=t=>new Promise(m=>setTimeout(m,t)),I=async t=>{const m=[];t.roles.forEach(o=>{const s=c.roles.find(a=>a.id===o||a.name===o);m.push(s.id)}),t.roles=m,t.id=n.id,g(!0),await axios.post(route("user.update",t)).then(o=>{g(!1),y(o.data.data),console.log(o.data.data),k.open({message:e.jsx(e.Fragment,{children:e.jsx("p",{className:"text-white",children:"Parabéns"})}),placement:"top",type:"success",description:e.jsx(e.Fragment,{children:e.jsx("p",{className:"text-white",children:"usuário foi actualizado com sucesso"})}),style:{fontSize:"12px",backgroundColor:"#344248"}})},o=>{M.error(),g(!1),k.open({message:e.jsx(e.Fragment,{children:e.jsx("p",{className:"text-white",children:"Erro"})}),placement:"top",type:"error",description:e.jsx(e.Fragment,{children:e.jsx("p",{className:"text-white",children:o.response.data.message})}),style:{fontSize:"12px",backgroundColor:"red"}})})};return r.useEffect(()=>{l===!0&&(S(!0),p(700).then(()=>{S(!1)}))},[n]),e.jsx(e.Fragment,{children:e.jsx(z,{className:"bg-red-300 rounded shadow",title:e.jsxs("p",{className:" text-lg font-weight-bold",children:["⚠️ Editar usuario:  ",n==null?void 0:n.name,w]}),open:l,onCancel:()=>{var t;d(!1),(t=j.current)==null||t.resetFields(),F(null)},width:1e3,okButtonProps:{className:"bg-red-400",loading:C},okText:"Salvar alterações",styles:{body:{backgroundColor:"#f1f5f9",padding:20}},onOk:()=>j.current.submit(),children:w?e.jsx(R,{active:!0}):e.jsxs(i,{ref:j,onFinish:I,layout:"vertical",initialValues:n,children:[e.jsxs(f,{gutter:16,className:"mt-4",children:[e.jsx(h,{span:12,children:e.jsx(i.Item,{name:"name",label:u("Nome do Tecnico"),rules:[{type:"string",required:!0,message:u("Ensira o nome do tecnico")}],children:e.jsx(x,{style:{width:"100%"},placeholder:u("Ensira um nome"),allowClear:!0,size:"middle",prefix:e.jsx(L,{})})})}),e.jsx(h,{span:12,children:e.jsx(i.Item,{name:"email",label:"Email",rules:[{type:"email",message:u("Por favor ensira um email"),required:!0}],children:e.jsx(x,{style:{width:"100%"},placeholder:u("ensira um email"),allowClear:!0})})})]}),e.jsx(f,{children:e.jsx(h,{className:"w-full",children:e.jsx(i.Item,{name:"roles",label:"Atribuir nova Função",rules:[{required:!0}],children:e.jsx(P,{allowClear:!0,showSearch:!0,placeholder:"indique a nova função ",mode:"multiple",optionFilterProp:"children",children:(b=c.roles)==null?void 0:b.map((t,m)=>e.jsx(P.Option,{value:t.id,children:t.name},m))})})})}),e.jsx(f,{children:e.jsx(h,{className:"w-full",children:e.jsx(i.Item,{name:"password",label:"Nova Senha",children:e.jsx(x.Password,{min:8,maxLength:8,name:"password",placeholder:"default: nome@123",allowClear:!0,showCount:!0})})})})]})},"user_edit")})}function ee(l){var o;const d=s=>s,[n,c]=r.useState(l.users.data),[F,y]=r.useState(!1),[j,C]=r.useState(!1),[g,w]=r.useState(null),[S,u]=r.useState(!1),p=r.useRef(null);async function I(s){await axios.put(route("user.delete",s)).then(a=>{const N=n.filter(v=>v.id!==s);c(N),k.open({message:e.jsx(e.Fragment,{children:e.jsx("p",{children:"Alerta ⚠️⚠️⚠️"})}),placement:"top",type:"warning",description:e.jsx(e.Fragment,{children:e.jsx("p",{children:"O usuario: "+a.data.name+" foi eliminado"})})})}).catch(a=>{console.log(a.message)})}const b=async s=>{u(!0),await axios.post(route("user.store",s)).then(a=>{u(!1),p.current.resetFields(),c(a.data.data),k.open({message:e.jsx(e.Fragment,{children:e.jsx("p",{className:"text-white",children:"Parabéns"})}),placement:"top",type:"success",description:e.jsx(e.Fragment,{children:e.jsx("p",{className:"text-white",children:"Um novo usuário foi criado com sucesso"})}),style:{fontSize:"12px",backgroundColor:"#344248"}})}).catch(a=>{console.log(a.message),u(!1),p.current.resetFields()})},t=[{title:"ID",dataIndex:"id",key:"id",render:s=>e.jsx("a",{children:s})},{title:"Name",dataIndex:"name",key:"name",render:s=>e.jsxs("a",{children:["👤 ",s]})},{title:"Email",dataIndex:"email",key:"email"},{title:"Nivel de acesso",dataIndex:"roles",key:"roles"},{title:"Data de criacao",dataIndex:"created_at",key:"created_at"},{title:"Action",key:"action",render:(s,a)=>e.jsxs(q,{size:"middle",className:"flex gap-1",children:[e.jsx(E,{type:"primary",onClick:()=>{w(a),C(!0)},children:"🖌️Editar"}),e.jsx(D,{onConfirm:()=>I(a.id),title:"Eliminar usuario ?",okText:"SIm tenho certeza",children:e.jsx(E,{type:"primary",className:"bg-red-400",children:"🗑️ Apagar"})})]})}],m=s=>{var a;if(s==="")c(l.users);else{let N=(a=l.users)==null?void 0:a.filter(v=>v.name.toLowerCase().includes(s.toLowerCase())||v.email.toLowerCase().includes(s.toLowerCase()));N.length>0?c(N):c(l.users)}};return e.jsxs(B,{user:l.auth.user,page:"lista de usuarios",header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:"Listas de Usuario"}),children:[e.jsx(O,{title:"Lista de Usuarios"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{}),e.jsx(E,{type:"primary",onClick:()=>y(!0),children:" + Registrar Novo usuario"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(x.Search,{placeholder:"Buscar usuario",allowClear:!0,className:"mb-4",onChange:s=>m(s.target.value)}),e.jsx(A,{columns:t,dataSource:n,className:"shadow"})]}),e.jsx(z,{className:"bg-slate-100 rounded shadow",title:"Criação de usuários e acessos",open:F,onCancel:()=>y(!1),width:1e3,okButtonProps:{className:"bg-red-400",loading:S},okText:"🎴 Salvar novo usuário",styles:{body:{backgroundColor:"#f1f5f9",padding:20}},onOk:()=>p.current.submit(),children:e.jsxs(i,{ref:p,onFinish:b,layout:"vertical",children:[e.jsxs(f,{gutter:16,className:"mt-4",children:[e.jsx(h,{span:12,children:e.jsx(i.Item,{name:"name",label:d("Nome do Tecnico"),rules:[{type:"string",required:!0,message:d("Ensira o nome do tecnico")}],children:e.jsx(x,{style:{width:"100%"},placeholder:d("Ensira um nome"),allowClear:!0,size:"middle",prefix:e.jsx(L,{})})})}),e.jsx(h,{span:12,children:e.jsx(i.Item,{name:"email",label:"Email",rules:[{type:"email",message:d("Por favor ensira um email"),required:!0}],children:e.jsx(x,{style:{width:"100%"},placeholder:d("ensira um email"),allowClear:!0})})})]}),e.jsx(f,{children:e.jsx(h,{className:"w-full",children:e.jsx(i.Item,{name:"roles",label:"Função",rules:[{required:!0}],children:e.jsx(P,{allowClear:!0,showSearch:!0,placeholder:"indique a função ",mode:"multiple",optionFilterProp:"children",children:(o=l.roles)==null?void 0:o.map((s,a)=>e.jsx(Option,{value:s.id,children:s.name},a))})})})}),e.jsx(f,{children:e.jsx(h,{className:"w-full",children:e.jsx(i.Item,{name:"password",label:"Senha",children:e.jsx(x.Password,{min:8,maxLength:8,name:"password",placeholder:"default: nome@123",allowClear:!0,showCount:!0})})})})]})},"user_create"),e.jsx(V,{openEdit:j,setOpenEdit:C,selectedUser:g,props:l,setSelectedUser:w,setDataSource:c})]})}export{ee as default};
